---
title: "Homework 2"
author: "Troy Layouni"
date: 2019-09-20
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


**The first step is to load the tidyverse package**

```{r packages} 
library(tidyverse) 
```

## Question 1

Reading in the Mr. Trash Wheel data from the first excel sheet titled "Mr. Trash Wheel" as well as:

  * Omitting non-data entries 
  * Cleaning the names of variables
  * Omitting rows not including dumpster-specific data
  * Rounding the "Sports Ball" variable to the nearest integer and converting it to an integer variable using as.integer

```{r, trash_wheel_Data}
library(readxl)

trash_wheel_data = read_excel("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
  sheet = "Mr. Trash Wheel", 
  range = "A2:N408") %>% 
  janitor::clean_names() %>%
  drop_na(dumpster) %>% 
  mutate(sports_balls = as.integer(sports_balls))
```

**Question 1, part 2: Reading in and cleaning precipitation data**

  * Omitting rows without data
  * Adding a year variable
  * Combining of both data on precipitation for 2017 and 2018
  * Converting the month number to a character variable for month name

Reading in and cleaning 2017 Precipitation data

```{r precipitation_data_2017}
precipitation_2017_data = read_excel("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "2017 Precipitation",
    range = "A2:B14") %>% 
    janitor::clean_names() %>%
    mutate(year = 2017) 
```

Reading in and cleaning 2018 Precipitation data

```{r precipitation_data_2018}
precipitation_2018_data = read_excel("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "2018 Precipitation",
    range = "A2:B14") %>% 
    janitor::clean_names() %>%
    mutate(year = 2018)    
```

Combining precipitation data for 2017 and 2018 and creating a character month variable 

```{r precipitation_data_full}
precipitation_data_full =
  bind_rows(precipitation_2017_data, precipitation_2018_data) %>% 
  mutate(month = month.name[month])
```

**Question 1, part 3: Describing the precipitation data**

The Mr. Trash Wheel dataset includes data on the contents of each dumpster filled from 2014-2019. There is information on sports balls collected, with a median of `r median(pull(filter(trash_wheel_data, year == 2017), sports_balls))` balls in each dumpster in 2017, as well as information on dumpster weight, averaging  `r mean(pull(filter(trash_wheel_data, year == 2018), weight_tons))` tons per dumpster in 2018, `r mean(pull(filter(trash_wheel_data, year == 2017), weight_tons))` tons in 2017, `r mean(pull(filter(trash_wheel_data, year == 2016), weight_tons))` tons in 2016,  `r mean(pull(filter(trash_wheel_data, year == 2015), weight_tons))` tons in 2015, and `r mean(pull(filter(trash_wheel_data, year == 2014), weight_tons))` tons in 2014. 

The data collected for precipitation in 2017 has `r nrow(precipitation_2017_data)` rows, one precipitation measure for each month, and has `r ncol(precipitation_2017_data)` columns, one for month, total precipitation, and year. In 2017, Baltimore, where Mr. Trash Wheel is located received a total of `r sum(pull(precipitation_2017_data, total))` inches of precipitation. The data collected for precipitation in 2018 also contains `r nrow(precipitation_2018_data)` rows, and has `r ncol(precipitation_2018_data)` columns, including the same information on total precipitation, month and year for 2018. According to these data, in 2018 Baltimore received `r sum(pull(precipitation_2018_data, total))` inches of precipitation.
These data were combined into one data frame containing `r nrow(precipitation_data_full)` rows, one for every month of 2017 and 2018 and `r ncol(precipitation_data_full)` columns. 

The mean monthly precipitation for 2017 is `r mean(pull(precipitation_2017_data, total))` inches (standard deviation of `r sd(pull(precipitation_2017_data, total))` inches)

The mean monthly precipitation is `r mean(pull(precipitation_2018_data, total))` inches (standard deviation of `r sd(pull(precipitation_2018_data, total))` inches). 

## Question 2

**Question 2, part 1: cleaning politician party affiliation data "pols-month" by:**

* breaking up data variable into month, day and year 
* creating a new variable called "president"
* removing "day" variable
* replacing month number with month name 

```{r political_party_data}
political_party_data = 
read_csv(file = "./data/fivethirtyeight_datasets/pols-month.csv") %>%
  separate(mon, sep = "-", into = c("year", "month", "day")) %>% 
  mutate(president = if_else(prez_dem < 1, "gop", "dem")) %>% 
  select(-day, -prez_dem, -prez_gop) %>% 
  mutate(month = month.name[(as.integer(month))]) %>% 
  mutate(year = as.numeric(year))
```

**Question 2, part 2: cleaning the stock market index data by:**

* breaking up data variable into month, day and year 
* replacing month number with month name 
* removing "day" variable 
* organize data according to year and month
* arrange data so that year and month are the first columns

```{r stock_market_data}
stock_market_data = 
read_csv(file = "./data/fivethirtyeight_datasets/snp.csv") %>%
  janitor::clean_names() %>% 
  separate(date, sep = "/", into = c("month", "day", "year")) %>% 
  mutate(month = as.factor(month)) %>% 
  arrange(year, month) %>%
  select(-day, year, month, close) %>% 
  mutate(month = month.name[(as.integer(month))]) %>% 
  mutate(year = as.numeric(year))
```

**Question 2, part 3: tidying the unemployment data by:** 

* use pivot_longer to create a month variable and percentage of unemployment variable 
* clean data 

```{r unemployment_data}
unemployment_data = 
read_csv(file = "./data/fivethirtyeight_datasets/unemployment.csv") %>%
  janitor::clean_names() %>% 
  pivot_longer(jan:dec, names_to = "month", values_to = "unemploy_percent") %>% 
  mutate(month = recode(month, "jan" = "January", "feb" = "February", "mar" = "March", "apr" = "April", "jun" = "June", "jul" = "July", "aug" = "August", "sep" = "September", "oct" = "October", "nov" = "November", "dec" = "December")) %>% 
mutate(year = as.numeric(year))

# mutate(month = match(month, month.abb)) 
 # mutate(month = month.name[month]) 
```

**Question 2, part 4: Joining datasets by merging political_party_data and stock_market_data, then merging unemployment into the result**

Merging stock_market_data into political_party_data

```{r}
political_stock_data = 
  left_join(political_party_data, stock_market_data, by = c("year", "month"))
```

Merging unemployment_data into political_stock_data

```{r}
fivethirtyeight_data = 
  left_join(political_stock_data, unemployment_data, by = c("year", "month"))
```

**Question 2, part 5: Summary of FiveThirtyEight data**


The FiveThirtyEight dataset (fivethirtyeight_data) contains information on political leaders party affiliation as well as stock market closing values and unemployment rates by year and month. This data contains `r ncol(fivethirtyeight_data)` rows, each representing different month and year in history, and `r nrow(fivethirtyeight_data)` columns. We can see that between `r min(pull(fivethirtyeight_data, year))` and `r max(pull(fivethirtyeight_data, year))`, unemployment at its lowest was `r min(pull(fivethirtyeight_data, unemploy_percent), na.rm = TRUE)` %. 







